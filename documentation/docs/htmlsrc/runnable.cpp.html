<!DOCTYPE html>
<html><head><title>Omni C++ Library - runnable.cpp</title>
<link rel="stylesheet" type="text/css" href="../../content/main.css" /><link rel="icon" type="image/png" href="../../content/favicon.png" />
<script type="text/javascript" src="../../content/common.js"></script></head><body><a name="topopage"></a>
<div class="main"><div class="menu"><div><ul><li title="About Omni"><div>Omni C++ Library</div><ul>
<li title="What is Omni?"><a href="../../about.html">What is Omni?</a></li><li title="A quick start guide">
<a href="../../getstarted.html">Getting Started</a></li><li title="Cross platform support"><a href="../../xplat.html">
Cross Platform</a></li><li title="Download or view the latest source"><a href="../../download.html">Downloads</a>
</li></ul></li><li title="Omni documentation"><div>Documentation</div><ul><li title="View the highlighted source">
<a href="index.html" class="current">Source</a></li><li title="Library classes and namespaces">
<a href="../classes/index.html">Class Index</a></li><li title="Download and view examples">
<a href="../examples/index.html">Examples</a></li><li title="Download and view build examples">
<a href="../build/index.html">Building</a></li><li title="Omni compiler options">
<a href="../options/index.html">Macros/Options</a></li><li title="System API/Library calls">
<a href="../api.html">System API</a></li><li title="Other Considerations">
<a href="../consider.html">Considerations</a></li><li title="Coding style and best practices">
<a href="../codestyle.html">Style/Best Practices</a></li></ul></li><li title="Search Omni"><div>Search</div><ul>
<li title="Search the source and documentation" id="srchli" name="srchli"><a href="../../search.html">Search the Library</a>
</li><li id="srchfrm" name="srchfrm" class="search"><form onsubmit="return false;">
<input name="omnisrch" id="omnisrch" type="text" /><img src="../../content/search.gif" /></form></li></ul></li>
</ul><div class="ftr"><div>(C) <a href="https://zeriph.com">Zeriph Enterprises</a></div></div></div></div><div class="info">
<!--start content-->
<div class="ptitle"><a href="../../files/src/runnable.cpp" onclick="return popup('../../files/src/runnable.cpp')">runnable.cpp</a></div><div class="content"><div>
<code><div class="cpphtmllines">
<!--start line numbers-->
000001:<br><div id="cmntl1" name="cmntl1">000002:<br>000003:<br>000004:<br>000005:<br>000006:<br>000007:<br>000008:<br>000009:<br>0000010:<br>0000011:<br>0000012:<br>0000013:<br>0000014:<br>0000015:<br>0000016:<br>0000017:<br>0000018:<br></div>0000019:<br>
0000020:<br>0000021:<br>0000022:<br>0000023:<br>0000024:<br>0000025:<br>0000026:<br>0000027:<br>0000028:<br>0000029:<br>0000030:<br>0000031:<br>0000032:<br>0000033:<br>0000034:<br>0000035:<br>0000036:<br>0000037:<br>0000038:<br>0000039:<br>
0000040:<br>0000041:<br>0000042:<br>0000043:<br>0000044:<br>0000045:<br>0000046:<br>0000047:<br>0000048:<br>0000049:<br>0000050:<br>0000051:<br>0000052:<br>0000053:<br>0000054:<br>0000055:<br>0000056:<br>0000057:<br>0000058:<br>0000059:<br>
0000060:<br>0000061:<br>0000062:<br>0000063:<br><div id="cmntl2" name="cmntl2">0000064:<br>0000065:<br>0000066:<br>0000067:<br></div>0000068:<br>0000069:<br>0000070:<br><div id="cmntl3" name="cmntl3">0000071:<br>0000072:<br>0000073:<br>0000074:<br>0000075:<br>0000076:<br>0000077:<br>0000078:<br>0000079:<br></div>
0000080:<br>0000081:<br>0000082:<br>0000083:<br>0000084:<br>0000085:<br>0000086:<br>0000087:<br>0000088:<br>0000089:<br>0000090:<br>0000091:<br>0000092:<br>0000093:<br>0000094:<br>0000095:<br>0000096:<br>0000097:<br>0000098:<br>0000099:<br>
00000100:<br>00000101:<br>00000102:<br>00000103:<br>00000104:<br>00000105:<br>00000106:<br>00000107:<br>00000108:<br>00000109:<br>00000110:<br>00000111:<br>00000112:<br>00000113:<br>00000114:<br>00000115:<br>00000116:<br>00000117:<br>00000118:<br>00000119:<br>
00000120:<br>00000121:<br>00000122:<br>00000123:<br>00000124:<br>00000125:<br>00000126:<br>00000127:<br>00000128:<br>00000129:<br>00000130:<br>00000131:<br>00000132:<br>00000133:<br>00000134:<br>00000135:<br>00000136:<br>00000137:<br>00000138:<br>00000139:<br>
00000140:<br>00000141:<br>00000142:<br>00000143:<br>00000144:<br>00000145:<br>00000146:<br>00000147:<br>00000148:<br>00000149:<br>00000150:<br>00000151:<br>00000152:<br>00000153:<br>00000154:<br>00000155:<br>00000156:<br>00000157:<br>00000158:<br>00000159:<br>
00000160:<br>00000161:<br>00000162:<br>00000163:<br>00000164:<br>00000165:<br>00000166:<br>00000167:<br>00000168:<br>00000169:<br>00000170:<br>00000171:<br>00000172:<br>00000173:<br>00000174:<br>00000175:<br>00000176:<br>00000177:<br>00000178:<br>00000179:<br>
00000180:<br>00000181:<br>00000182:<br>00000183:<br>00000184:<br>00000185:<br>00000186:<br>00000187:<br>00000188:<br>00000189:<br>00000190:<br>00000191:<br>00000192:<br>00000193:<br>00000194:<br>00000195:<br>00000196:<br>00000197:<br>00000198:<br>00000199:<br>
00000200:<br>00000201:<br>00000202:<br>00000203:<br>00000204:<br>00000205:<br>00000206:<br>00000207:<br>00000208:<br>00000209:<br>00000210:<br>00000211:<br>00000212:<br>00000213:<br>00000214:<br>00000215:<br>00000216:<br>00000217:<br>00000218:<br>00000219:<br>
00000220:<br>00000221:<br>00000222:<br>00000223:<br>00000224:<br>00000225:<br>00000226:<br>00000227:<br>00000228:<br>00000229:<br>00000230:<br>00000231:<br>00000232:<br>00000233:<br>00000234:<br>00000235:<br>00000236:<br>00000237:<br>00000238:<br>00000239:<br>
00000240:<br>00000241:<br>00000242:<br>00000243:<br>00000244:<br>00000245:<br>00000246:<br>00000247:<br>00000248:<br>00000249:<br>00000250:<br>00000251:<br>00000252:<br>00000253:<br>00000254:<br>00000255:<br>00000256:<br>00000257:<br>00000258:<br>00000259:<br>
00000260:<br>00000261:<br>00000262:<br>00000263:<br>00000264:<br>00000265:<br>00000266:<br>00000267:<br>00000268:<br>00000269:<br>00000270:<br>00000271:<br>00000272:<br>00000273:<br>00000274:<br>00000275:<br>00000276:<br>00000277:<br>00000278:<br>00000279:<br>
00000280:<br>00000281:<br>00000282:<br>00000283:<br>00000284:<br>00000285:<br>00000286:<br>00000287:<br>00000288:<br>00000289:<br>00000290:<br>00000291:<br>00000292:<br>00000293:<br>00000294:<br>00000295:<br>00000296:<br>00000297:<br>00000298:<br>00000299:<br>
00000300:<br>00000301:<br>00000302:<br>00000303:<br>00000304:<br>00000305:<br>00000306:<br>00000307:<br>00000308:<br>00000309:<br>00000310:<br>00000311:<br>00000312:<br>00000313:<br>00000314:<br>00000315:<br>00000316:<br>00000317:<br>00000318:<br>00000319:<br>
00000320:<br>00000321:<br>00000322:<br>00000323:<br>00000324:<br>00000325:<br>00000326:<br>00000327:<br>00000328:<br>00000329:<br>00000330:<br>00000331:<br>00000332:<br>00000333:<br>00000334:<br>00000335:<br>00000336:<br>00000337:<br>00000338:<br>00000339:<br>
00000340:<br>00000341:<br>00000342:<br>00000343:<br>00000344:<br>00000345:<br>00000346:<br>00000347:<br>00000348:<br>00000349:<br>00000350:<br>00000351:<br>00000352:<br>00000353:<br>00000354:<br>00000355:<br>00000356:<br>00000357:<br>00000358:<br>00000359:<br>
00000360:<br>00000361:<br>00000362:<br>00000363:<br>00000364:<br>00000365:<br>00000366:<br>00000367:<br>00000368:<br>00000369:<br>00000370:<br>00000371:<br>00000372:<br>00000373:<br>00000374:<br>00000375:<br>00000376:<br>00000377:<br>00000378:<br>00000379:<br>
00000380:<br>00000381:<br>00000382:<br>00000383:<br>00000384:<br>00000385:<br>00000386:<br>00000387:<br>00000388:<br>00000389:<br>00000390:<br>00000391:<br><div id="cmntl4" name="cmntl4">00000392:<br>00000393:<br>00000394:<br>00000395:<br>00000396:<br>00000397:<br>00000398:<br>00000399:<br>
00000400:<br>00000401:<br>00000402:<br>00000403:<br>00000404:<br>00000405:<br>00000406:<br>00000407:<br>00000408:<br>00000409:<br>00000410:<br>00000411:<br>00000412:<br>00000413:<br>00000414:<br>00000415:<br></div>00000416:<br>00000417:<br>00000418:<br>00000419:<br>
00000420:<br>00000421:<br>00000422:<br>00000423:<br>00000424:<br>00000425:<br>00000426:<br>00000427:<br>00000428:<br>00000429:<br>00000430:<br>00000431:<br>00000432:<br>00000433:<br>00000434:<br>00000435:<br>00000436:<br>00000437:<br>00000438:<br>00000439:<br>
00000440:<br>00000441:<br>00000442:<br>00000443:<br>00000444:<br>00000445:<br>00000446:<br>00000447:<br>00000448:<br>00000449:<br>00000450:<br>00000451:<br>00000452:<br>00000453:<br><div id="cmntl5" name="cmntl5">00000454:<br>00000455:<br></div>00000456:<br>00000457:<br>00000458:<br>00000459:<br>
00000460:<br>00000461:<br>00000462:<br>00000463:<br>00000464:<br>00000465:<br>00000466:<br>00000467:<br>00000468:<br>00000469:<br>00000470:<br>00000471:<br>00000472:<br>00000473:<br>00000474:<br>00000475:<br>00000476:<br>00000477:<br>00000478:<br>00000479:<br>
00000480:<br>00000481:<br>00000482:<br>00000483:<br>00000484:<br>00000485:<br>00000486:<br>00000487:<br>00000488:<br>00000489:<br>00000490:<br>00000491:<br>00000492:<br>00000493:<br>00000494:<br>00000495:<br>00000496:<br>00000497:<br>00000498:<br>00000499:<br>
00000500:<br>00000501:<br>00000502:<br>00000503:<br>00000504:<br>00000505:<br>00000506:<br>00000507:<br>00000508:<br>00000509:<br>00000510:<br>00000511:<br>00000512:<br>00000513:<br>00000514:<br>00000515:<br>00000516:<br>00000517:<br>00000518:<br>00000519:<br>
00000520:<br>00000521:<br>00000522:<br>00000523:<br>00000524:<br>00000525:<br>00000526:<br>00000527:<br>00000528:<br>00000529:<br>00000530:<br>00000531:<br>00000532:<br>00000533:<br>00000534:<br>00000535:<br>00000536:<br>00000537:<br>00000538:<br>00000539:<br>
00000540:<br>00000541:<br>00000542:<br>00000543:<br>00000544:<br>00000545:<br>00000546:<br>00000547:<br>00000548:<br>00000549:<br>00000550:<br>00000551:<br>00000552:<br>00000553:<br>00000554:<br>00000555:<br>00000556:<br>00000557:<br>00000558:<br>00000559:<br>
00000560:<br>00000561:<br>00000562:<br>00000563:<br>00000564:<br>00000565:<br>00000566:<br>00000567:<br>00000568:<br>00000569:<br>00000570:<br>00000571:<br>00000572:<br>00000573:<br>00000574:<br>00000575:<br>00000576:<br>00000577:<br>00000578:<br>00000579:<br>
00000580:<br>00000581:<br>00000582:<br>00000583:<br>00000584:<br>00000585:<br>00000586:<br>00000587:<br>00000588:<br>00000589:<br>00000590:<br>00000591:<br>00000592:<br>00000593:<br>00000594:<br>00000595:<br>00000596:<br>00000597:<br>00000598:<br>00000599:<br>
00000600:<br>00000601:<br>00000602:<br>00000603:<br>00000604:<br>00000605:<br>00000606:<br>00000607:<br>00000608:<br>00000609:<br>00000610:<br>00000611:<br>00000612:<br>00000613:<br>00000614:<br>00000615:<br>00000616:<br>00000617:<br>00000618:<br>00000619:<br>
00000620:<br>00000621:<br>00000622:<br>00000623:<br>00000624:<br>00000625:<br>00000626:<br>00000627:<br>00000628:<br>00000629:<br>00000630:<br>00000631:<br>00000632:<br>00000633:<br>00000634:<br>00000635:<br>00000636:<br>00000637:<br>00000638:<br>00000639:<br>
00000640:<br>00000641:<br>00000642:<br>00000643:<br>00000644:<br>00000645:<br>00000646:<br>00000647:<br>00000648:<br>00000649:<br>00000650:<br>00000651:<br>00000652:<br>00000653:<br>00000654:<br>00000655:<br>00000656:<br>00000657:<br>00000658:<br>00000659:<br>
00000660:<br>00000661:<br>00000662:<br>00000663:<br>00000664:<br>00000665:<br>00000666:<br>00000667:<br>00000668:<br>00000669:<br>00000670:<br>00000671:<br>00000672:<br>00000673:<br>00000674:<br>00000675:<br>00000676:<br>00000677:<br>00000678:<br>00000679:<br>
00000680:<br>00000681:<br>00000682:<br>00000683:<br>00000684:<br>00000685:<br>00000686:<br>00000687:<br>00000688:<br>00000689:<br>00000690:<br>00000691:<br>00000692:<br>00000693:<br>00000694:<br>00000695:<br>00000696:<br>00000697:<br>00000698:<br>00000699:<br>
00000700:<br>00000701:<br>00000702:<br>00000703:<br>00000704:<br>00000705:<br>00000706:<br>00000707:<br>00000708:<br>00000709:<br>00000710:<br>00000711:<br>00000712:<br>00000713:<br>00000714:<br>00000715:<br>00000716:<br>00000717:<br>00000718:<br>00000719:<br>
00000720:<br>00000721:<br>00000722:<br>00000723:<br>00000724:<br>00000725:<br>00000726:<br>00000727:<br>00000728:<br>00000729:<br>00000730:<br>00000731:<br>00000732:<br>00000733:<br>00000734:<br>00000735:<br>00000736:<br>00000737:<br>00000738:<br>00000739:<br>
00000740:<br>00000741:<br>00000742:<br>00000743:<br>00000744:<br>00000745:<br>00000746:<br>00000747:<br>00000748:<br>00000749:<br>00000750:<br>00000751:<br>00000752:<br>00000753:<br>00000754:<br>00000755:<br>00000756:<br>00000757:<br>00000758:<br>00000759:<br>
00000760:<br>00000761:<br>00000762:<br>00000763:<br>00000764:<br><div id="cmntl6" name="cmntl6">00000765:<br>00000766:<br>00000767:<br></div>00000768:<br>00000769:<br>00000770:<br>00000771:<br><div id="cmntl7" name="cmntl7">00000772:<br></div>00000773:<br>00000774:<br>00000775:<br>00000776:<br>00000777:<br>00000778:<br>00000779:<br>
00000780:<br>00000781:<br>00000782:<br>00000783:<br>00000784:<br>00000785:<br>00000786:<br>00000787:<br>00000788:<br>00000789:<br>00000790:<br>00000791:<br>00000792:<br>00000793:<br>00000794:<br>00000795:<br>00000796:<br>00000797:<br>00000798:<br>00000799:<br>
00000800:<br>00000801:<br>00000802:<br>00000803:<br>00000804:<br>00000805:<br>00000806:<br>00000807:<br>00000808:<br>00000809:<br>00000810:<br>00000811:<br>00000812:<br>00000813:<br>00000814:<br>00000815:<br>00000816:<br>00000817:<br>00000818:<br>00000819:<br>
00000820:<br>00000821:<br>00000822:<br>00000823:<br>00000824:<br>00000825:<br>00000826:<br>00000827:<br>00000828:<br>00000829:<br>00000830:<br>00000831:<br>00000832:<br>00000833:<br>00000834:<br>00000835:<br>00000836:<br>00000837:<br>00000838:<br>00000839:<br>
00000840:<br>00000841:<br>00000842:<br>00000843:<br>00000844:<br>00000845:<br>00000846:<br>00000847:<br>00000848:<br>00000849:<br>00000850:<br>00000851:<br>00000852:<br>00000853:<br>00000854:<br>00000855:<br>00000856:<br>00000857:<br>00000858:<br>00000859:<br>
00000860:<br>00000861:<br>00000862:<br>00000863:<br>00000864:<br>00000865:<br>00000866:<br>00000867:<br>00000868:<br>00000869:<br>00000870:<br>00000871:<br>00000872:<br>00000873:<br>00000874:<br>00000875:<br>00000876:<br>00000877:<br>00000878:<br>00000879:<br>
00000880:<br>00000881:<br>00000882:<br>00000883:<br>00000884:<br>00000885:<br>00000886:<br>00000887:<br>00000888:<br>00000889:<br>00000890:<br>00000891:<br>00000892:<br><div id="cmntl8" name="cmntl8">00000893:<br></div>00000894:<br>00000895:<br>00000896:<br>00000897:<br>00000898:<br>00000899:<br>
00000900:<br>00000901:<br>00000902:<br>00000903:<br>00000904:<br>00000905:<br>00000906:<br>00000907:<br>00000908:<br>00000909:<br>00000910:<br>00000911:<br>00000912:<br>00000913:<br>00000914:<br>00000915:<br>00000916:<br>00000917:<br>00000918:<br>00000919:<br>
00000920:<br>00000921:<br>00000922:<br>00000923:<br>00000924:<br>00000925:<br>00000926:<br>00000927:<br>00000928:<br>00000929:<br>00000930:<br>00000931:<br>00000932:<br>00000933:<br>00000934:<br>00000935:<br>00000936:<br>00000937:<br>00000938:<br>00000939:<br>
00000940:<br>00000941:<br>00000942:<br>00000943:<br>00000944:<br>00000945:<br>00000946:<br>00000947:<br>00000948:<br>00000949:<br>00000950:<br>00000951:<br>00000952:<br>00000953:<br>00000954:<br>00000955:<br>00000956:<br>00000957:<br>00000958:<br>00000959:<br>
00000960:<br>00000961:<br>00000962:<br>00000963:<br>00000964:<br>00000965:<br>00000966:<br><div id="cmntl9" name="cmntl9">00000967:<br></div>00000968:<br>00000969:<br>00000970:<br>00000971:<br>00000972:<br>00000973:<br>00000974:<br>00000975:<br>00000976:<br>00000977:<br>00000978:<br>00000979:<br>
00000980:<br>00000981:<br><div id="cmntl10" name="cmntl10">00000982:<br>00000983:<br>00000984:<br></div>00000985:<br>00000986:<br>00000987:<br><div id="cmntl11" name="cmntl11">00000988:<br></div>00000989:<br>00000990:<br>00000991:<br>00000992:<br>00000993:<br>00000994:<br>00000995:<br>00000996:<br>00000997:<br>00000998:<br>00000999:<br>
000001000:<br>000001001:<br>000001002:<br>000001003:<br>000001004:<br>000001005:<br>000001006:<br>000001007:<br>000001008:<br>000001009:<br>000001010:<br>000001011:<br>000001012:<br><div id="cmntl12" name="cmntl12">000001013:<br>000001014:<br>000001015:<br>000001016:<br>000001017:<br>000001018:<br>000001019:<br>
000001020:<br>000001021:<br>000001022:<br>000001023:<br>000001024:<br>000001025:<br>000001026:<br>000001027:<br>000001028:<br>000001029:<br>000001030:<br></div>000001031:<br>000001032:<br>000001033:<br>000001034:<br>000001035:<br>000001036:<br>000001037:<br>000001038:<br>000001039:<br>
000001040:<br>000001041:<br>000001042:<br>000001043:<br>000001044:<br>000001045:<br>000001046:<br>000001047:<br>000001048:<br>000001049:<br>000001050:<br>000001051:<br>000001052:<br>000001053:<br>000001054:<br>000001055:<br>000001056:<br>000001057:<br>
<!--end line numbers-->
</div><div class="cpphtmlcmnt">
<!--start collapse columns-->
<img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti1" name="cmnti1" onclick="collapse('1', '../../');" /><br><div id="cmnts1" name="cmnts1"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div></div><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti2" name="cmnti2" onclick="collapse('2', '../../');" /><br><div id="cmnts2" name="cmnts2"><br><br><br><br></div><div></div><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti3" name="cmnti3" onclick="collapse('3', '../../');" /><br><div id="cmnts3" name="cmnts3"><br><br><br><br><br><br><br><br><br></div><div></div>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti4" name="cmnti4" onclick="collapse('4', '../../');" /><br><div id="cmnts4" name="cmnts4"><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div></div><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti5" name="cmnti5" onclick="collapse('5', '../../');" /><br><div id="cmnts5" name="cmnts5"><br><br></div><div></div><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti6" name="cmnti6" onclick="collapse('6', '../../');" /><br><div id="cmnts6" name="cmnts6"><br><br><br></div><div></div><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti7" name="cmnti7" onclick="collapse('7', '../../');" /><br><div id="cmnts7" name="cmnts7"><br></div><div></div><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti8" name="cmnti8" onclick="collapse('8', '../../');" /><br><div id="cmnts8" name="cmnts8"><br></div><div></div><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti9" name="cmnti9" onclick="collapse('9', '../../');" /><br><div id="cmnts9" name="cmnts9"><br></div><div></div><br><br><br><br><br><br><br><br><br><br><br><br>
<br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti10" name="cmnti10" onclick="collapse('10', '../../');" /><br><div id="cmnts10" name="cmnts10"><br><br><br></div><div></div><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti11" name="cmnti11" onclick="collapse('11', '../../');" /><br><div id="cmnts11" name="cmnts11"><br></div><div></div><br><br><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><img src="../../content/tree/min.gif" alt="Min/Max" id="cmnti12" name="cmnti12" onclick="collapse('12', '../../');" /><br><div id="cmnts12" name="cmnts12"><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br></div><div></div><br><br><br><br><br><br><br><br><br>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
<!--end collapse columns-->
</div><div class="cpphtml" style="margin-left:4.3em;">
<!--start highlighted code-->
<font class="syn_cmt">/*<div class="syn_ex" id="cmnt1" name="cmnt1">
 * Copyright (c), Zeriph Enterprises<br>
 * All rights reserved.<br>
 * <br>
 * Contributor(s):<br>
 * Zechariah Perez, omni (at) zeriph (dot) com<br>
 * <br>
 * THIS SOFTWARE IS PROVIDED BY ZERIPH AND CONTRIBUTORS &quot;AS IS&quot; AND ANY<br>
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED<br>
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE<br>
 * DISCLAIMED. IN NO EVENT SHALL ZERIPH AND CONTRIBUTORS BE LIABLE FOR ANY<br>
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES<br>
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;<br>
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND<br>
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT<br>
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS<br>
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.<br>
 */</div><div></div></font>
<font class="syn_pre">#include &lt;<a href="omni/sync/runnable_thread.hpp.html">omni/sync/runnable_thread.hpp</a>&gt;</font><br>
<font class="syn_pre">#include &lt;<a href="omni/chrono/tick.hpp.html">omni/chrono/tick.hpp</a>&gt;</font><br>
<font class="syn_pre">#include &lt;<a href="omni/consts/cconsts.hpp.html">omni/consts/cconsts.hpp</a>&gt;</font><br>
<font class="syn_pre">#include &lt;<a href="omni/exception.hpp.html">omni/exception.hpp</a>&gt;</font><br>
<font class="syn_pre">#if !defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// need the following for POSIX thread set prio/join</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#include &lt;unistd.h&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#include &lt;sched.h&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#include &lt;ctime&gt;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#include &lt;cstring&gt;</font><br>
<font class="syn_pre">#endif</font><br>
<br>
<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_RPRIO_FW  m_priority(<a href="../classes/omni-sync-thread_priority-normal.html">omni::sync::thread_priority::NORMAL</a>),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_RPRIO_CP_FW m_priority(cp.m_priority),</font><br>
<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_RPRIO_FW</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_RPRIO_CP_FW </font><br>
<font class="syn_pre">#endif</font><br>
<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_safe_runnable_thread.html">OMNI_SAFE_RUNNABLE_THREAD</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RMTX_FW  m_mtx(),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RLOCK_FW   this-&gt;m_mtx.lock();</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RUNLOCK_FW this-&gt;m_mtx.unlock();</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RALOCK_FW  <a href="../classes/omni-sync-scoped_lock.html">omni::sync::scoped_lock</a>&lt;<a href="../classes/omni-sync-basic_lock.html">omni::sync::basic_lock</a>&gt; smal(&amp;this-&gt;m_mtx);</font><br>
<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RMTX_FW</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RLOCK_FW</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RUNLOCK_FW</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#define OMNI_SAFE_RALOCK_FW</font><br>
<font class="syn_pre">#endif</font><br>
<br>
<font class="syn_ins">namespace</font> omni {<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">namespace</font> sync {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">typedef</font> <font class="syn_typ">struct</font> runnable_thread_args {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>* bthread;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-spin_wait.html">omni::sync::spin_wait</a> swait;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} runnable_thread_args;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
<font class="syn_cmt">///////// static thread management methods /////////</font><br>
<br>
<a href="../options/omni_thread_fnptr_t.html">OMNI_THREAD_FNPTR_T</a> <a href="../options/omni_thread_call_t.html">OMNI_THREAD_CALL_T</a> <a href="../classes/omni-sync-runnable_thread-_start.html">omni::sync::runnable_thread::_start</a>(<font class="syn_typ">void</font>* param)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* runnables are different from thread or basic_thread in that they are directly managed code.<div class="syn_ex" id="cmnt2" name="cmnt2">
&nbsp;&nbsp;&nbsp;&nbsp;That is to say, it does not make sense to detach a runnable, so there is no mechanism to do so,<br>
&nbsp;&nbsp;&nbsp;&nbsp;as such, there is no need to keep &quot;track&quot; of anything other than the pointer to the member<br>
&nbsp;&nbsp;&nbsp;&nbsp;(and the handle to close it for Windows) since an <a href="../classes/omni-sync-runnable.html">omni::sync::runnable</a> should be owned by the coder<br>
&nbsp;&nbsp;&nbsp;&nbsp;and if it is deleted before this thread ends, the results will be undefined */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>* t = (<font class="syn_ins">static_cast</font>&lt;omni::sync::runnable_thread_args*&gt;(param))-&gt;bthread;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/*<div class="syn_ex" id="cmnt3" name="cmnt3">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we do not check for any errors here as it is not a good idea to ever kill a thread.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setting to async cancel type sets the cross platform compatibility as TerminateThread<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is async in nature.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!!!! NOTE !!!!<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remember, it is a better idea to use abort and the state_changed handler to end<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;your threads nicely (avoid resource leaks)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::<a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_setcancelstate.html">pthread_setcanceltype</a>(PTHREAD_CANCEL_ASYNCHRONOUS, <font class="syn_typ">NULL</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (t-&gt;m_priority != <a href="../classes/omni-sync-thread_priority-normal.html">omni::sync::thread_priority::NORMAL</a>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D4_FW(<font class="syn_str">&quot;setting thread priority&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;_set_prio();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (t-&gt;m_iface) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_THREAD_TRY_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-running.html">omni::sync::thread_state::RUNNING</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<font class="syn_ins">static_cast</font>&lt;omni::sync::runnable_thread_args*&gt;(param))-&gt;swait.signal();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;m_iface-&gt;run(t-&gt;m_args);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_THREAD_CATCH_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// should not happen since this should be caught in the calling thread::start</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../options/omni_dbge.html">OMNI_DBGE</a>(<a href="../options/omni_invalid_delegate_func_str.html">OMNI_INVALID_DELEGATE_FUNC_STR</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_THROW_FW(<a href="../classes/omni-exceptions-invalid_delegate.html">omni::exceptions::invalid_delegate</a>())<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// if nothrow then act as killed</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// DEV_NOTE: if OMNI_THROW_FW is defined, you might get warnings about this code being unreachable</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;m_state = <a href="../classes/omni-sync-thread_state-stop_requested.html">omni::sync::thread_state::STOP_REQUESTED</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// A stop request would mean a user killing this thread, and if that succeeded then we would not get here</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">switch</font> (t-&gt;m_state) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_state::RUNNING:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-completed.html">omni::sync::thread_state::COMPLETED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_state::ABORT_REQUESTED:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-aborted.html">omni::sync::thread_state::ABORTED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_state::STOP_REQUESTED:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_state::UNSTARTED: <font class="syn_ins">case</font> omni::sync::thread_state::START_REQUESTED:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_state::COMPLETED: <font class="syn_ins">case</font> omni::sync::thread_state::STOPPED:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_state::ABORTED: <font class="syn_ins">case</font> omni::sync::thread_state::UNKNOWN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">default</font>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-stopped.html">omni::sync::thread_state::STOPPED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;t-&gt;_hreset();<br>
&nbsp;&nbsp;&nbsp;&nbsp;t = <a href="../options/omni_null.html">OMNI_NULL</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_num">0</font>;<br>
}<br>
<br>
<font class="syn_cmt">///////// public methods /////////</font><br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>() : <br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CTOR_FW(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(<a href="../options/omni_null.html">OMNI_NULL</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(<font class="syn_num">0</font>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_chrono_auto_init_tick.html">OMNI_CHRONO_AUTO_INIT_TICK</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-monotonic-initialize.html">omni::chrono::monotonic::initialize</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_iface = <font class="syn_typ">this</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;thread created&quot;</font>);<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; cp) : <br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-runnable.html">omni::sync::runnable</a>(cp),<br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(cp.state_changed),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CPCTOR_FW(cp)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(cp.m_args),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(cp.m_iface),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(cp.m_tid),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(cp.m_thread),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(cp.m_ops),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(cp.m_state),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_CP_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(cp.m_isjoined)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;thread copied&quot;</font>);<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>(<font class="syn_typ">const</font> <a href="../classes/omni-sync-thread_flags.html">omni::sync::thread_flags</a>&amp; ops) : <br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CTOR_FW(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(<a href="../options/omni_null.html">OMNI_NULL</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(ops),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(<font class="syn_num">0</font>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_chrono_auto_init_tick.html">OMNI_CHRONO_AUTO_INIT_TICK</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-monotonic-initialize.html">omni::chrono::monotonic::initialize</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_iface = <font class="syn_typ">this</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;thread const copied&quot;</font>);<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>(<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a> max_stack_sz) : <br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CTOR_FW(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(<a href="../options/omni_null.html">OMNI_NULL</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(max_stack_sz),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(<font class="syn_num">0</font>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_chrono_auto_init_tick.html">OMNI_CHRONO_AUTO_INIT_TICK</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-monotonic-initialize.html">omni::chrono::monotonic::initialize</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_iface = <font class="syn_typ">this</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">//OMNI_DV5_FW(&quot;thread created with stack size of &quot;, this-&gt;m_ops.stack_size);</font><br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable.html">omni::sync::runnable</a>&amp; obj) :<br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CTOR_FW(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(<font class="syn_ins">const_cast</font>&lt;<a href="../classes/omni-sync-runnable.html">omni::sync::runnable</a>*&gt;(&amp;obj)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(<font class="syn_num">0</font>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_chrono_auto_init_tick.html">OMNI_CHRONO_AUTO_INIT_TICK</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-monotonic-initialize.html">omni::chrono::monotonic::initialize</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;thread created with delegate method&quot;</font>);<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable.html">omni::sync::runnable</a>&amp; obj, <a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a> max_stack_sz) :<br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CTOR_FW(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(<font class="syn_ins">const_cast</font>&lt;<a href="../classes/omni-sync-runnable.html">omni::sync::runnable</a>*&gt;(&amp;obj)),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(max_stack_sz),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(<font class="syn_num">0</font>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_chrono_auto_init_tick.html">OMNI_CHRONO_AUTO_INIT_TICK</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-monotonic-initialize.html">omni::chrono::monotonic::initialize</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;thread created with delegate method&quot;</font>);<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-runnable_thread.html">omni::sync::runnable_thread::runnable_thread</a>(<a href="../classes/omni-sync-thread_option-enum_t.html">omni::sync::thread_option::enum_t</a> op, <a href="../classes/omni-sync-thread_union_t.html">omni::sync::thread_union_t</a> val) : <br>
&nbsp;&nbsp;&nbsp;&nbsp;state_changed(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CTOR_FW(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RMTX_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_args(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_iface(<a href="../options/omni_null.html">OMNI_NULL</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_tid(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_thread(<font class="syn_num">0</font>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_ops(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_state(<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>),<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_RPRIO_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;m_isjoined(<font class="syn_num">0</font>)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_chrono_auto_init_tick.html">OMNI_CHRONO_AUTO_INIT_TICK</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-monotonic-initialize.html">omni::chrono::monotonic::initialize</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_iface = <font class="syn_typ">this</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;thread created with specific options&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;set_option(op, val);<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread-@7Erunnable_thread.html">omni::sync::runnable_thread::~runnable_thread</a>() <a href="../options/omni_dtor_throws.html">OMNI_DTOR_THROWS</a><br>
{   <br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_TRY_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_DTOR_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">bool</font> do_detach = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;_hvalid() &amp;&amp; <font class="syn_typ">this</font>-&gt;_state_running()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.detach_on_destroy()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_hreset(<font class="syn_ins">true</font>); <font class="syn_cmt">// detach</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_detach = <font class="syn_ins">false</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.abort_on_destroy()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state = <a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;state_update(<a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;state_changed) { <font class="syn_typ">this</font>-&gt;state_changed(*<font class="syn_typ">this</font>, <a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.auto_join()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a> to = <font class="syn_typ">this</font>-&gt;m_ops.auto_join_timeout();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (to &gt; <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">bool</font> kod = <font class="syn_typ">this</font>-&gt;m_ops.kill_on_destroy();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;join(<font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">uint32_t</font>&gt;(to));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (kod) { <font class="syn_typ">this</font>-&gt;kill(); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;join();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.kill_on_destroy()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;kill();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (do_detach) { <font class="syn_typ">this</font>-&gt;_hreset(<font class="syn_ins">true</font>); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_CATCH_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D5_FW(<font class="syn_str">&quot;destroyed&quot;</font>);<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-abort.html">omni::sync::runnable_thread::abort</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">bool</font> valid = <font class="syn_typ">this</font>-&gt;_hvalid();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">bool</font> running = <font class="syn_typ">this</font>-&gt;_state_running();<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!valid) { OMNI_ERR_FW(<a href="../options/omni_invalid_thread_handle_str.html">OMNI_INVALID_THREAD_HANDLE_STR</a>, <a href="../classes/omni-exceptions-invalid_thread_handle.html">omni::exceptions::invalid_thread_handle</a>()) }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (running) { <font class="syn_typ">this</font>-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_dbg_l3.html">OMNI_DBG_L3</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">else</font> { OMNI_D3_FW(<font class="syn_str">&quot;thread is not running&quot;</font>); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-abort_join.html">omni::sync::runnable_thread::abort_join</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;abort();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;join();<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-abort_join.html">omni::sync::runnable_thread::abort_join</a>(<font class="syn_typ">uint32_t</font> timeout)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;abort();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;join(timeout);<br>
}<br>
<br>
<font class="syn_typ">const</font> <a href="../classes/omni-sync-thread_union_t.html">omni::sync::thread_union_t</a> <a href="../classes/omni-sync-runnable_thread-get_option.html">omni::sync::runnable_thread::get_option</a>(<a href="../classes/omni-sync-thread_option-enum_t.html">omni::sync::thread_option::enum_t</a> op) <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">switch</font> (op) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::ALLOW_THREAD_REUSE:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.allow_reuse();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::AUTO_JOIN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.auto_join();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::DETACH_ON_DESTROY:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.detach_on_destroy();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::ABORT_ON_DESTROY:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.abort_on_destroy();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::KILL_ON_DESTROY:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.kill_on_destroy();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::DETACH_ON_ASSIGN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.detach_on_assign();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::ABORT_ON_ASSIGN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.abort_on_assign();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::KILL_ON_ASSIGN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.kill_on_assign();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::STACK_SIZE:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.stack_size();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::AUTO_JOIN_TIMEOUT:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops.auto_join_timeout();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::NONE:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">default</font>: <font class="syn_cmt">// invalid_option</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;invalid option: &quot;</font>, op, <a href="../classes/omni-exceptions-invalid_thread_option.html">omni::exceptions::invalid_thread_option</a>(<font class="syn_ins">static_cast</font>&lt;<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a>&gt;(op)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">false</font>;<br>
}<br>
<br>
<a href="../classes/omni-sync-thread_flags.html">omni::sync::thread_flags</a> <a href="../classes/omni-sync-runnable_thread-get_options.html">omni::sync::runnable_thread::get_options</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_ops;<br>
}<br>
<br>
<a href="../classes/omni-sync-thread_handle_t.html">omni::sync::thread_handle_t</a> <a href="../classes/omni-sync-runnable_thread-handle.html">omni::sync::runnable_thread::handle</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_thread;<br>
}<br>
<br>
<a href="../classes/omni-sync-thread_t.html">omni::sync::thread_t</a> <a href="../classes/omni-sync-runnable_thread-id.html">omni::sync::runnable_thread::id</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_tid;<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-is_alive.html">omni::sync::runnable_thread::is_alive</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/*<div class="syn_ex" id="cmnt4" name="cmnt4">
&nbsp;&nbsp;&nbsp;&nbsp;DEV_NOTE: we do not use pthread_kill or GetExitCodeThread<br>
&nbsp;&nbsp;&nbsp;&nbsp;since those might give erroneous results for these purposes.<br>
&nbsp;&nbsp;&nbsp;&nbsp;That is to say, using JUST those APIs will not guarantee<br>
&nbsp;&nbsp;&nbsp;&nbsp;that our underlying thread is actually running.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a> = 0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread has completed its function (method complete)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-completed.html">omni::sync::thread_state::COMPLETED</a> = 4,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread is stopped (killed)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-stopped.html">omni::sync::thread_state::STOPPED</a> = 16,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread has been aborted<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-aborted.html">omni::sync::thread_state::ABORTED</a> = 64,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread is attempting to spawn<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-start_requested.html">omni::sync::thread_state::START_REQUESTED</a> = 1,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread is running (method has been called)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-running.html">omni::sync::thread_state::RUNNING</a> = 2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread has a stop request (kill request)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-stop_requested.html">omni::sync::thread_state::STOP_REQUESTED</a> = 8,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread has an abort request<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a> = 32,<br>
&nbsp;&nbsp;&nbsp;&nbsp;// Defines a thread has a state that can not be determined (when creating threads from handles for instance)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-unknown.html">omni::sync::thread_state::UNKNOWN</a> = 255<br>
&nbsp;&nbsp;&nbsp;&nbsp;*/</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;_hvalid() &amp;&amp; <font class="syn_typ">this</font>-&gt;_state_running();<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-join.html">omni::sync::runnable_thread::join</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;join(<a href="../options/omni_infinite_timeout.html">OMNI_INFINITE_TIMEOUT</a>);<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-join.html">omni::sync::runnable_thread::join</a>(<font class="syn_typ">uint32_t</font> timeout)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// Unknown states can still be joined</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;is_alive()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D2_FW(<font class="syn_str">&quot;thread is not running&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;_hvalid()) { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RETV_FW(<a href="../options/omni_invalid_thread_handle_str.html">OMNI_INVALID_THREAD_HANDLE_STR</a>, <a href="../classes/omni-exceptions-invalid_thread_handle.html">omni::exceptions::invalid_thread_handle</a>(), <font class="syn_ins">false</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_handle_t.html">omni::sync::thread_handle_t</a> hndl = <font class="syn_typ">this</font>-&gt;m_thread;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (hndl == <a href="../classes/omni-sync-thread_handle.html">omni::sync::thread_handle</a>()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RETV_FW(<a href="../options/omni_invalid_thread_owner_str.html">OMNI_INVALID_THREAD_OWNER_STR</a>, <a href="../classes/omni-exceptions-invalid_thread_owner.html">omni::exceptions::invalid_thread_owner</a>(), <font class="syn_ins">false</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_isjoined = <font class="syn_num">1</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(::<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms687032%28v=vs.85%29.aspx">WaitForSingleObject</a>(OMNI_WIN_TOHNDL_FW(hndl), timeout) == <font class="syn_num">0</font>) ? <font class="syn_ins">true</font> :<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_dbg_l1.html">OMNI_DBG_L1</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">false</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!(OMNI_DBGEV_FW(<font class="syn_str">&quot;error while waiting for thread handle: &quot;</font>, <a href="../options/omni_gle_prnt.html">OMNI_GLE_PRNT</a>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* There is not a portable mechanism with pthreads to wait on a specific thread without<div class="syn_ex" id="cmnt5" name="cmnt5">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implementing a timed_wait condition variable. We do not want the user to have to implement<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a seperate variable based on system, so we implement a timeout loop*/</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_isjoined = <font class="syn_num">1</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (timeout != <a href="../options/omni_infinite_timeout.html">OMNI_INFINITE_TIMEOUT</a>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../options/omni_sleep_init.html">OMNI_SLEEP_INIT</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">volatile</font> <font class="syn_typ">bool</font> iav = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-chrono-tick_t.html">omni::chrono::tick_t</a> ts = <a href="../classes/omni-chrono-monotonic_tick.html">omni::chrono::monotonic_tick</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// iav = (::<a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_kill.html">pthread_kill</a>(hndl, 0) != ESRCH); // == &quot;alive&quot;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">while</font> ((iav = (::<a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_kill.html">pthread_kill</a>(hndl, <font class="syn_num">0</font>) != ESRCH)) &amp;&amp; (<a href="../classes/omni-chrono-elapsed_ms.html">omni::chrono::elapsed_ms</a>(ts) &lt; timeout)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../options/omni_sleep1.html">OMNI_SLEEP1</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> (::<a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_kill.html">pthread_kill</a>(hndl, <font class="syn_num">0</font>) == ESRCH); <font class="syn_cmt">// == &quot;dead&quot;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(::<a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_join.html">pthread_join</a>(hndl, <font class="syn_typ">NULL</font>) == <font class="syn_num">0</font>) ? <font class="syn_ins">true</font> :<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#if !defined(<a href="../options/omni_dbg_l1.html">OMNI_DBG_L1</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">false</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!(OMNI_DBGEV_FW(<font class="syn_str">&quot;error while waiting for thread handle: &quot;</font>, <a href="../options/omni_gle_prnt.html">OMNI_GLE_PRNT</a>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-join.html">omni::sync::runnable_thread::join</a>(<font class="syn_typ">const</font> <a href="../classes/omni-chrono-unsigned_span_t.html">omni::chrono::unsigned_span_t</a>&amp; span)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;join(<font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">uint32_t</font>&gt;(span.total_milliseconds()));<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-kill.html">omni::sync::runnable_thread::kill</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;is_alive()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// threads already dead, no need to kill</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D2_FW(<font class="syn_str">&quot;thread is not running&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;_hvalid()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RETV_FW(<a href="../options/omni_invalid_thread_handle_str.html">OMNI_INVALID_THREAD_HANDLE_STR</a>, <a href="../classes/omni-exceptions-invalid_thread_handle.html">omni::exceptions::invalid_thread_handle</a>(), <font class="syn_ins">false</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> perr = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_handle_t.html">omni::sync::thread_handle_t</a> hndl = <font class="syn_typ">this</font>-&gt;m_thread;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (hndl == <a href="../classes/omni-sync-thread_handle.html">omni::sync::thread_handle</a>()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RETV_FW(<a href="../options/omni_invalid_thread_owner_str.html">OMNI_INVALID_THREAD_OWNER_STR</a>, <a href="../classes/omni-exceptions-invalid_thread_owner.html">omni::exceptions::invalid_thread_owner</a>(), <font class="syn_ins">false</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-stop_requested.html">omni::sync::thread_state::STOP_REQUESTED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// attempt to kill it</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (::<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686717%28v=vs.85%29.aspx">TerminateThread</a>(OMNI_WIN_TOHNDL_FW(hndl), <font class="syn_num">0</font>) == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = <a href="../options/omni_gle.html">OMNI_GLE</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = ::<a href="http://pubs.opengroup.org/onlinepubs/007908799/xsh/pthread_cancel.html">pthread_cancel</a>(hndl);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-stopped.html">omni::sync::thread_state::STOPPED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_hreset();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_DV1_FW(<font class="syn_str">&quot;thread termination error code: &quot;</font>, perr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// Something unknown happened...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_state_changed(<a href="../classes/omni-sync-thread_state-unknown.html">omni::sync::thread_state::UNKNOWN</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">false</font>;<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-reset.html">omni::sync::runnable_thread::reset</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;is_alive()) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RETV_FW(<font class="syn_str">&quot;cannot reset thread while running&quot;</font>, <a href="../classes/omni-exceptions-thread_running_exception.html">omni::exceptions::thread_running_exception</a>(), <font class="syn_ins">false</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_hreset(<font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">true</font>;<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-restart.html">omni::sync::runnable_thread::restart</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;reset()) { <font class="syn_ins">return</font> <font class="syn_ins">false</font>; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;start();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">true</font>;<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-restart.html">omni::sync::runnable_thread::restart</a>(<a href="../classes/omni-sync-thread_arg_t.html">omni::sync::thread_arg_t</a> args)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;reset()) { <font class="syn_ins">return</font> <font class="syn_ins">false</font>; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;start(args);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_ins">true</font>;<br>
}<br>
<br>
<a href="../classes/omni-sync-thread_state.html">omni::sync::thread_state</a> <a href="../classes/omni-sync-runnable_thread-status.html">omni::sync::runnable_thread::status</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_state;<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-set_option.html">omni::sync::runnable_thread::set_option</a>(<a href="../classes/omni-sync-thread_option-enum_t.html">omni::sync::thread_option::enum_t</a> op, <a href="../classes/omni-sync-thread_union_t.html">omni::sync::thread_union_t</a> val)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">switch</font> (op) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::STACK_SIZE:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_stack_size(val.s_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::AUTO_JOIN_TIMEOUT:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.s_val &gt; <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// if timeout &gt; 0 then auto join should be true</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-auto_join.html">omni::sync::thread_option::AUTO_JOIN</a>, <font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// auto-join over-rides detach (since detach is default)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_auto_join_timeout(val.s_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::ALLOW_THREAD_REUSE:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-allow_thread_reuse.html">omni::sync::thread_option::ALLOW_THREAD_REUSE</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::AUTO_JOIN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.b_val) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// auto-join over-rides detach</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-auto_join.html">omni::sync::thread_option::AUTO_JOIN</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::DETACH_ON_DESTROY:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.b_val) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// if the user sets detach, then auto-join should be false</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-auto_join.html">omni::sync::thread_option::AUTO_JOIN</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::ABORT_ON_DESTROY:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.b_val) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// abort over-rides detach</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-kill_on_destroy.html">omni::sync::thread_option::KILL_ON_DESTROY</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-abort_on_destroy.html">omni::sync::thread_option::ABORT_ON_DESTROY</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::KILL_ON_DESTROY:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.b_val) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-abort_on_destroy.html">omni::sync::thread_option::ABORT_ON_DESTROY</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-kill_on_destroy.html">omni::sync::thread_option::KILL_ON_DESTROY</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::DETACH_ON_ASSIGN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_assign.html">omni::sync::thread_option::DETACH_ON_ASSIGN</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::ABORT_ON_ASSIGN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.b_val) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_assign.html">omni::sync::thread_option::DETACH_ON_ASSIGN</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-abort_on_assign.html">omni::sync::thread_option::ABORT_ON_ASSIGN</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::KILL_ON_ASSIGN:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (val.b_val) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-abort_on_assign.html">omni::sync::thread_option::ABORT_ON_ASSIGN</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_assign.html">omni::sync::thread_option::DETACH_ON_ASSIGN</a>, <font class="syn_ins">false</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-kill_on_assign.html">omni::sync::thread_option::KILL_ON_ASSIGN</a>, val.b_val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">case</font> omni::sync::thread_option::NONE:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">default</font>:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;invalid option: &quot;</font>, op, <a href="../classes/omni-exceptions-invalid_thread_option.html">omni::exceptions::invalid_thread_option</a>(<font class="syn_ins">static_cast</font>&lt;<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a>&gt;(op)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">break</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-set_options.html">omni::sync::runnable_thread::set_options</a>(<font class="syn_typ">unsigned</font> <font class="syn_typ">char</font> op, <font class="syn_typ">bool</font> val)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">bool</font> valid_op = <font class="syn_ins">false</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-allow_thread_reuse.html">omni::sync::thread_option::ALLOW_THREAD_REUSE</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-allow_thread_reuse.html">omni::sync::thread_option::ALLOW_THREAD_REUSE</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-auto_join.html">omni::sync::thread_option::AUTO_JOIN</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-auto_join.html">omni::sync::thread_option::AUTO_JOIN</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_destroy.html">omni::sync::thread_option::DETACH_ON_DESTROY</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-abort_on_destroy.html">omni::sync::thread_option::ABORT_ON_DESTROY</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-abort_on_destroy.html">omni::sync::thread_option::ABORT_ON_DESTROY</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-kill_on_destroy.html">omni::sync::thread_option::KILL_ON_DESTROY</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-kill_on_destroy.html">omni::sync::thread_option::KILL_ON_DESTROY</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-detach_on_assign.html">omni::sync::thread_option::DETACH_ON_ASSIGN</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-detach_on_assign.html">omni::sync::thread_option::DETACH_ON_ASSIGN</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-abort_on_assign.html">omni::sync::thread_option::ABORT_ON_ASSIGN</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-abort_on_assign.html">omni::sync::thread_option::ABORT_ON_ASSIGN</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="../options/omni_val_has_flag_bit.html">OMNI_VAL_HAS_FLAG_BIT</a>(op, <a href="../classes/omni-sync-thread_option-kill_on_assign.html">omni::sync::thread_option::KILL_ON_ASSIGN</a>)) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops.set_flag(<a href="../classes/omni-sync-thread_option-kill_on_assign.html">omni::sync::thread_option::KILL_ON_ASSIGN</a>, val);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;valid_op = <font class="syn_ins">true</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!valid_op) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;invalid option: &quot;</font>, op, <a href="../classes/omni-exceptions-invalid_thread_option.html">omni::exceptions::invalid_thread_option</a>(<font class="syn_ins">static_cast</font>&lt;<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a>&gt;(op)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-set_options.html">omni::sync::runnable_thread::set_options</a>(<font class="syn_typ">const</font> <a href="../classes/omni-sync-thread_flags.html">omni::sync::thread_flags</a>&amp; ops)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops = ops;<br>
}<br>
<br>
<a href="../classes/omni-sync-thread_t.html">omni::sync::thread_t</a> <a href="../classes/omni-sync-runnable_thread-start.html">omni::sync::runnable_thread::start</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;start(<a href="../options/omni_thread_arg_null_t.html">OMNI_THREAD_ARG_NULL_T</a>);<br>
}<br>
<br>
<a href="../classes/omni-sync-thread_t.html">omni::sync::thread_t</a> <a href="../classes/omni-sync-runnable_thread-start.html">omni::sync::runnable_thread::start</a>(<a href="../classes/omni-sync-thread_arg_t.html">omni::sync::thread_arg_t</a> args)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_state != <a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.allow_reuse()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// thread reuse is enabled, so reset the handles</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_hreset(<font class="syn_ins">true</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RET_FW(<font class="syn_str">&quot;can not start a thread once it has been started or if it is in an unknown state&quot;</font>, <a href="../classes/omni-exceptions-thread_running_exception.html">omni::exceptions::thread_running_exception</a>())<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_iface == <a href="../options/omni_null.html">OMNI_NULL</a>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// no delegate attached to this thread so we cannot actually start anything</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_RET_FW(<a href="../options/omni_invalid_delegate_func_str.html">OMNI_INVALID_DELEGATE_FUNC_STR</a>, <a href="../classes/omni-exceptions-invalid_delegate.html">omni::exceptions::invalid_delegate</a>())<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> perr = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;omni::sync::runnable_thread_args bargs;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-enum_t.html">omni::sync::thread_state::enum_t</a> ostate = <font class="syn_typ">this</font>-&gt;m_state;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a> stack_size = <font class="syn_typ">this</font>-&gt;m_ops.stack_size();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_args = args;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state = <a href="../classes/omni-sync-thread_state-start_requested.html">omni::sync::thread_state::START_REQUESTED</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;state_update(ostate);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;state_changed) { <font class="syn_typ">this</font>-&gt;state_changed(*<font class="syn_typ">this</font>, ostate); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;bargs.bthread = <font class="syn_typ">this</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_TMPIDT_FW tmptid = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = OMNI_CREATE_THREAD_FW(<font class="syn_typ">NULL</font>, <font class="syn_cmt">// default security attr</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  stack_size, <font class="syn_cmt">// stack size</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &amp;<a href="../classes/omni-sync-runnable_thread-_start.html">omni::sync::runnable_thread::_start</a>, <font class="syn_cmt">// _start(void*)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">void</font>*&gt;(&amp;bargs), <font class="syn_cmt">// args</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <font class="syn_num">0</font>, <font class="syn_cmt">// start now</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &amp;tmptid); <font class="syn_cmt">// thread id</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// Win32 returns !0 for a valid thread, 0 means error</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_thread == <font class="syn_num">0</font>) { perr = <a href="../options/omni_gle.html">OMNI_GLE</a>; } <font class="syn_cmt">// error, set perr</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">else</font> { <font class="syn_typ">this</font>-&gt;m_tid = <font class="syn_ins">static_cast</font>&lt;<a href="../classes/omni-sync-thread_t.html">omni::sync::thread_t</a>&gt;(tmptid); } <font class="syn_cmt">// success, set tid</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// if any of these fails, then thread creation should fail</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (stack_size == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = ::<a href="http://pubs.opengroup.org/onlinepubs/007908775/xsh/pthread_create.html">pthread_create</a>(&amp;<font class="syn_typ">this</font>-&gt;m_tid, <font class="syn_cmt">// the thread id</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">NULL</font>, <font class="syn_cmt">// stack size == 0, so null attributes</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;<a href="../classes/omni-sync-runnable_thread-_start.html">omni::sync::runnable_thread::_start</a>, <font class="syn_cmt">// _start(void*)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">void</font>*&gt;(&amp;bargs)); <font class="syn_cmt">// args</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = <font class="syn_typ">this</font>-&gt;m_tid; <font class="syn_cmt">// copy TID to m_thread handle</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;system create thread failed: &quot;</font>, perr, <a href="../classes/omni-exceptions-thread_exception.html">omni::exceptions::thread_exception</a>(<font class="syn_str">&quot;Create system thread failed: &quot;</font>, perr));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pthread_attr_t attr;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = ::<a href="http://pubs.opengroup.org/onlinepubs/007908799/xsh/pthread_attr_init.html">pthread_attr_init</a>(&amp;attr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = ::<a href="http://pubs.opengroup.org/onlinepubs/007908775/xsh/pthread_attr_setstacksize.html">pthread_attr_setstacksize</a>(&amp;attr, stack_size);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = ::<a href="http://pubs.opengroup.org/onlinepubs/007908775/xsh/pthread_create.html">pthread_create</a>(&amp;<font class="syn_typ">this</font>-&gt;m_tid, <font class="syn_cmt">// the thread id</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;attr, <font class="syn_cmt">// stack size</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;<a href="../classes/omni-sync-runnable_thread-_start.html">omni::sync::runnable_thread::_start</a>, <font class="syn_cmt">// _start(void*)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">void</font>*&gt;(&amp;bargs)); <font class="syn_cmt">// args</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = <font class="syn_typ">this</font>-&gt;m_tid; <font class="syn_cmt">// copy TID to m_thread handle</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;system create thread failed: &quot;</font>, perr, <a href="../classes/omni-exceptions-thread_exception.html">omni::exceptions::thread_exception</a>(<font class="syn_str">&quot;Create system thread failed: &quot;</font>, perr))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_FW(<font class="syn_str">&quot;could not set stack size of &quot;</font> &lt;&lt; stack_size &lt;&lt; <font class="syn_str">&quot;: &quot;</font> &lt;&lt; perr, <a href="../classes/omni-exceptions-thread_exception.html">omni::exceptions::thread_exception</a>(<font class="syn_str">&quot;System error setting stack size: &quot;</font>, perr));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// Destroy the attributes handle</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perr = ::<a href="http://pubs.opengroup.org/onlinepubs/007908799/xsh/pthread_attr_init.html">pthread_attr_destroy</a>(&amp;attr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr != <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* in theory this should only ever happen if attr is not valid<div class="syn_ex" id="cmnt6" name="cmnt6">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but to be safe we want to alert the user since this could signal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other issues (we also do not want any rouge handles not being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destroyed, ie a memory leak) */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;could not destroy attributes: &quot;</font>, perr, <a href="../classes/omni-exceptions-thread_exception.html">omni::exceptions::thread_exception</a>(<font class="syn_str">&quot;Could not destroy attributes: &quot;</font>, perr));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* if we got here then there were other errors in thread creation, so<div class="syn_ex" id="cmnt7" name="cmnt7">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do not reset the perr value, just call the function */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::<a href="http://pubs.opengroup.org/onlinepubs/007908799/xsh/pthread_attr_init.html">pthread_attr_destroy</a>(&amp;attr);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_FW(<font class="syn_str">&quot;could not initialize thread attributes @&quot;</font> &lt;&lt; &amp;attr &lt;&lt; <font class="syn_str">&quot;: &quot;</font> &lt;&lt; perr, <a href="../classes/omni-exceptions-thread_exception.html">omni::exceptions::thread_exception</a>(<font class="syn_str">&quot;Could not initialize thread attributes: &quot;</font>, perr));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (perr == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D4_FW(<font class="syn_str">&quot;thread handle valid, waiting for thread switch&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// valid handle so wait until the thread is actually reported as started</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bargs.swait.sleep_wait();<br>
&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_FW(<font class="syn_str">&quot;could not create system thread: &quot;</font>, perr, <a href="../classes/omni-exceptions-thread_exception.html">omni::exceptions::thread_exception</a>(perr))<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_D<font class="syn_num">3</font>_FW(((<font class="syn_typ">this</font>-&gt;m_tid == <font class="syn_num">0</font>) ? <font class="syn_str">&quot;invalid&quot;</font> : <font class="syn_str">&quot;created&quot;</font>) &lt;&lt; <font class="syn_str">&quot; thread:&quot;</font> &lt;&lt; <font class="syn_typ">this</font>-&gt;m_tid);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_tid;<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-swap.html">omni::sync::runnable_thread::swap</a>(<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; o)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font> != &amp;o) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_safe_thread.html">OMNI_SAFE_THREAD</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_mtx.lock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o.m_mtx.lock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// hmmm .... ??</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;state_changed, o.state_changed);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_args, o.m_args);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_iface, o.m_iface);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_tid, o.m_tid);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_thread, o.m_thread);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_ops, o.m_ops);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_state, o.m_state);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_priority, o.m_priority);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/algorithm/swap/">std::swap</a>(<font class="syn_typ">this</font>-&gt;m_isjoined, o.m_isjoined);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_safe_thread.html">OMNI_SAFE_THREAD</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_mtx.unlock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o.m_mtx.unlock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// old code only here for direct reference...</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// we do not get a copy because of the thread dtor</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">//<a href="../classes/omni-sync-thread.html">omni::sync::thread</a> tmp(o); // get a copy</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">//o._set_context(*this);</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">//this-&gt;_set_context(tmp);</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
<a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; omni::sync::runnable_thread::<font class="syn_ins">operator</font>=(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; o)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font> != &amp;o) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;_hvalid() &amp;&amp; <font class="syn_typ">this</font>-&gt;_state_running()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.detach_on_assign()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_hreset(<font class="syn_ins">true</font>); <font class="syn_cmt">// detach</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.abort_on_assign()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state = <a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;state_update(<a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;state_changed) { <font class="syn_typ">this</font>-&gt;state_changed(*<font class="syn_typ">this</font>, <a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a>); }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.kill_on_assign()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;kill();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ASSIGN_FW(o)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_set_context(o);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> *<font class="syn_typ">this</font>;<br>
}<br>
<br>
<font class="syn_typ">bool</font> omni::sync::runnable_thread::<font class="syn_ins">operator</font>==(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; o) <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font> == &amp;o) { <font class="syn_ins">return</font> <font class="syn_ins">true</font>; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_safe_runnable_thread.html">OMNI_SAFE_RUNNABLE_THREAD</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-scoped_lock.html">omni::sync::scoped_lock</a>&lt;<a href="../classes/omni-sync-basic_lock.html">omni::sync::basic_lock</a>&gt; am(&amp;<font class="syn_typ">this</font>-&gt;m_mtx);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-scoped_lock.html">omni::sync::scoped_lock</a>&lt;<a href="../classes/omni-sync-basic_lock.html">omni::sync::basic_lock</a>&gt; am2(&amp;o.m_mtx);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> (<font class="syn_typ">this</font>-&gt;state_changed == o.state_changed &amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_args == o.m_args &amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops == o.m_ops &amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_iface == o.m_iface &amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state == o.m_state &amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_tid == o.m_tid &amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread == o.m_thread<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <font class="syn_typ">this</font>-&gt;m_priority == o.m_priority<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_EQUAL_FW(o)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br>
}<br>
<br>
<font class="syn_typ">bool</font> omni::sync::runnable_thread::<font class="syn_ins">operator</font>!=(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; o) <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> !(*<font class="syn_typ">this</font> == o);<br>
}<br>
<br>
<font class="syn_cmt">///////// start private methods /////////</font><br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-_close_handle.html">omni::sync::runnable_thread::_close_handle</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state = <a href="../classes/omni-sync-thread_state-unstarted.html">omni::sync::thread_state::UNSTARTED</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_thread != <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// detach the handle so the OS can cleanup when it is done</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724211%28v=vs.85%29.aspx">CloseHandle</a>(OMNI_WIN_TOHNDL_FW(<font class="syn_typ">this</font>-&gt;m_thread));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_isjoined == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* if we have called pthread_join on this thread then do not detach<div class="syn_ex" id="cmnt8" name="cmnt8">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it as that releases it is resources and makes it unjoinable */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;::<a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_detach.html">pthread_detach</a>(<font class="syn_typ">this</font>-&gt;m_thread);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_isjoined = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_tid = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = <font class="syn_num">0</font>;<br>
}<br>
<br>
<font class="syn_typ">void</font> omni::sync::runnable_thread::_hreset(<font class="syn_typ">bool</font> force)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_priority = <a href="../classes/omni-sync-thread_priority-normal.html">omni::sync::thread_priority::NORMAL</a>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;m_ops.allow_reuse() || force) { <font class="syn_typ">this</font>-&gt;_close_handle(); }<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-_hvalid.html">omni::sync::runnable_thread::_hvalid</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> (<font class="syn_typ">this</font>-&gt;m_thread != <font class="syn_num">0</font>);<br>
}<br>
<br>
<font class="syn_typ">bool</font> <a href="../classes/omni-sync-runnable_thread-_state_running.html">omni::sync::runnable_thread::_state_running</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> (<font class="syn_typ">this</font>-&gt;m_state == <a href="../classes/omni-sync-thread_state-running.html">omni::sync::thread_state::RUNNING</a> ||<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state == <a href="../classes/omni-sync-thread_state-stop_requested.html">omni::sync::thread_state::STOP_REQUESTED</a> ||<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state == <a href="../classes/omni-sync-thread_state-abort_requested.html">omni::sync::thread_state::ABORT_REQUESTED</a> ||<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state == <a href="../classes/omni-sync-thread_state-unknown.html">omni::sync::thread_state::UNKNOWN</a>);<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-_state_changed.html">omni::sync::runnable_thread::_state_changed</a>(<a href="../classes/omni-sync-thread_state-enum_t.html">omni::sync::thread_state::enum_t</a> nstate)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<a href="../classes/omni-sync-thread_state-enum_t.html">omni::sync::thread_state::enum_t</a> ostate = <font class="syn_typ">this</font>-&gt;m_state;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state = nstate;<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;state_update(ostate);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;state_changed) { <font class="syn_typ">this</font>-&gt;state_changed(*<font class="syn_typ">this</font>, ostate); }<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-_set_context.html">omni::sync::runnable_thread::_set_context</a>(<font class="syn_typ">const</font> <a href="../classes/omni-sync-runnable_thread.html">omni::sync::runnable_thread</a>&amp; t2)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_safe_runnable_thread.html">OMNI_SAFE_RUNNABLE_THREAD</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_mtx.lock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2.m_mtx.lock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;state_changed = t2.state_changed;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_args = t2.m_args;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_iface = t2.m_iface;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_tid = t2.m_tid;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_thread = t2.m_thread;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_ops = t2.m_ops;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_state = t2.m_state;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_priority = t2.m_priority;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_isjoined = t2.m_isjoined;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_safe_runnable_thread.html">OMNI_SAFE_RUNNABLE_THREAD</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2.m_mtx.unlock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_mtx.unlock();<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
}<br>
<br>
<font class="syn_cmt">///////// non portable methods /////////</font><br>
<br>
<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_non_portable.html">OMNI_NON_PORTABLE</a>)</font><br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-_set_prio.html">omni::sync::runnable_thread::_set_prio</a>()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> pri = <font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">int</font>&gt;(<font class="syn_typ">this</font>-&gt;m_priority);<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_DV4_FW(<font class="syn_str">&quot;changing priority to &quot;</font>, pri);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* we do not throw an error if we cannot set the thread priority since the<div class="syn_ex" id="cmnt9" name="cmnt9">
&nbsp;&nbsp;&nbsp;&nbsp;OS could decide not to do it any ways or the system may not support it */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_os_win.html">OMNI_OS_WIN</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (::<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686277%28v=vs.85%29.aspx">SetThreadPriority</a>(OMNI_WIN_TOHNDL_FW(<font class="syn_typ">this</font>-&gt;m_thread), pri) == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../options/omni_dbge.html">OMNI_DBGE</a>(<a href="../options/omni_err_set_pri_str.html">OMNI_ERR_SET_PRI_STR</a> &lt;&lt; <font class="syn_str">&quot;: &quot;</font> &lt;&lt; <a href="../options/omni_gle.html">OMNI_GLE</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#else</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> sched = <font class="syn_num">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">struct</font> sched_param param;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.cplusplus.com/reference/cstring/memset/">std::memset</a>(&amp;param, <font class="syn_num">0</font>, <font class="syn_ins">sizeof</font>(sched_param));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<a href="http://pubs.opengroup.org/onlinepubs/007908775/xsh/pthread_getschedparam.html">pthread_getschedparam</a>(<font class="syn_typ">this</font>-&gt;m_thread, &amp;sched, &amp;param) == <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> min = ::<a href="http://pubs.opengroup.org/onlinepubs/007908775/xsh/sched_get_priority_max.html">sched_get_priority_min</a>(sched);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> max = ::<a href="http://pubs.opengroup.org/onlinepubs/007908775/xsh/sched_get_priority_max.html">sched_get_priority_max</a>(sched);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (pri &lt; min) { pri = min; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (pri &gt; max) { pri = max; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* if max &lt; min, there are system errors, however, if min == max<div class="syn_ex" id="cmnt10" name="cmnt10">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chances are the scheduling priority is OS dependant (i.e. min=0, max=0 for SCHED_OTHER)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thus, the OS will decide the scheduling priority for the thread<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regardless if we set the thread priority. */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (max &gt; min) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> skip = (max - min) / <a href="../classes/omni-sync-thread_priority-count.html">omni::sync::thread_priority::COUNT</a>();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/* getting a normalized value that is representative of<div class="syn_ex" id="cmnt11" name="cmnt11">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this-&gt;m_priority according to the system scheduling policy */</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.sched_priority = (min + ((pri+<font class="syn_num">2</font>) * (skip+<font class="syn_num">1</font>))) + (skip / <font class="syn_num">2</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (::<a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_getschedparam.html">pthread_setschedparam</a>(<font class="syn_typ">this</font>-&gt;m_thread, sched, &amp;param) != <font class="syn_num">0</font>) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="../options/omni_dbge.html">OMNI_DBGE</a>(<a href="../options/omni_err_set_pri_str.html">OMNI_ERR_SET_PRI_STR</a> &lt;&lt; <font class="syn_str">&quot;: &quot;</font> &lt;&lt; <a href="../options/omni_gle.html">OMNI_GLE</a>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_show_debug_err.html">OMNI_SHOW_DEBUG_ERR</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">else</font> { <a href="../options/omni_dbgev.html">OMNI_DBGEV</a>(<a href="../options/omni_err_set_pri_str.html">OMNI_ERR_SET_PRI_STR</a>, <font class="syn_str">&quot;: sched prio max &lt;= min&quot;</font>) }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre"><font class="syn_pre">#if defined(<a href="../options/omni_show_debug_err.html">OMNI_SHOW_DEBUG_ERR</a>)</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">else</font> { <a href="../options/omni_dbge.html">OMNI_DBGE</a>(<a href="../options/omni_err_set_pri_str.html">OMNI_ERR_SET_PRI_STR</a> &lt;&lt; <font class="syn_str">&quot;: &quot;</font> &lt;&lt; <a href="../options/omni_gle.html">OMNI_GLE</a>) }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_pre">#endif</font><br>
}<br>
<br>
<a href="../classes/omni-sync-thread_priority.html">omni::sync::thread_priority</a> <a href="../classes/omni-sync-runnable_thread-priority.html">omni::sync::runnable_thread::priority</a>() <font class="syn_typ">const</font><br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">return</font> <font class="syn_typ">this</font>-&gt;m_priority;<br>
}<br>
<br>
<font class="syn_typ">void</font> <a href="../classes/omni-sync-runnable_thread-set_priority.html">omni::sync::runnable_thread::set_priority</a>(<a href="../classes/omni-sync-thread_priority-enum_t.html">omni::sync::thread_priority::enum_t</a> p)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">/*<div class="syn_ex" id="cmnt12" name="cmnt12">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEV_NOTE: Thread scheduling is system dependent, this means that even<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;though you can ask the scheduler to set a threads priority, it will not always listen.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some systems implement a more robust scheduler; OpenBSD for instance implements<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a type of round robin scheduler that schedules threads according to set priority.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Others implement a load based scheduler; Ubuntu (and quite a few other Linux variants)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for example implement an approach where by a thread is scheduled on it is priority<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;only when the CPU is under heavy stress, otherwise all threads get equal priority.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As such, setting the thread priority is not guaranteed (per MSDN and the POSIX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;documentation), which means while we can give this functionality to you in a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;platform independent manor, be aware that thread priorities are in fact<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system dependent and even the systems themselves state they cannot guarantee<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setting the priority will mean anything.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To a degree this makes sense in the fact that allowing a user land thread to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;have a higher priority than a kernel thread could be potentially harmful, so<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;again be aware of this non guaranteed function.<br>
&nbsp;&nbsp;&nbsp;&nbsp;*/</div><div></div></font>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">int</font> pri = <font class="syn_ins">static_cast</font>&lt;<font class="syn_typ">int</font>&gt;(p);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (pri &lt; <a href="../classes/omni-sync-thread_priority-lowest.html">omni::sync::thread_priority::LOWEST</a>) { pri = <a href="../classes/omni-sync-thread_priority-idle.html">omni::sync::thread_priority::IDLE</a>; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (pri &gt; <a href="../classes/omni-sync-thread_priority-highest.html">omni::sync::thread_priority::HIGHEST</a>) { pri = <a href="../classes/omni-sync-thread_priority-real_time.html">omni::sync::thread_priority::REAL_TIME</a>; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> ((pri &lt; <a href="../classes/omni-sync-thread_priority-lowest.html">omni::sync::thread_priority::LOWEST</a> &amp;&amp; pri != <a href="../classes/omni-sync-thread_priority-idle.html">omni::sync::thread_priority::IDLE</a>) ||<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(pri &gt; <a href="../classes/omni-sync-thread_priority-highest.html">omni::sync::thread_priority::HIGHEST</a> &amp;&amp; pri != <a href="../classes/omni-sync-thread_priority-real_time.html">omni::sync::thread_priority::REAL_TIME</a>))<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// invalid_priority</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERRV_RET_FW(<font class="syn_str">&quot;invalid priority: &quot;</font>, pri, <a href="../classes/omni-exceptions-invalid_thread_option.html">omni::exceptions::invalid_thread_option</a>(<font class="syn_ins">static_cast</font>&lt;<a href="http://www.cplusplus.com/reference/cstring/size_t/">std::size_t</a>&gt;(pri)))<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// if we are not running, just set the priority til next time</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;m_priority = pri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RUNLOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (<font class="syn_typ">this</font>-&gt;is_alive()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_SAFE_RALOCK_FW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_cmt">// we can only set the priority if the thread is running and handle is valid</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_ins">if</font> (!<font class="syn_typ">this</font>-&gt;_hvalid()) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OMNI_ERR_FW(<a href="../options/omni_invalid_thread_handle_str.html">OMNI_INVALID_THREAD_HANDLE_STR</a>, <a href="../classes/omni-exceptions-invalid_thread_handle.html">omni::exceptions::invalid_thread_handle</a>())<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <font class="syn_ins">else</font> {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font class="syn_typ">this</font>-&gt;_set_prio();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
<font class="syn_pre">#endif</font><br>
<!--end highlighted code-->
</div></code><br>
<!--end content-->
</div></div></div></div><script type="text/javascript">loadJS(); collapseAll('12', '../../');</script></body></html>
